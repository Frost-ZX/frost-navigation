import{_ as x,m as D,A as w,g as C,I as S,aA as K,D as B,x as V,n as H,o as d,bJ as k,q as $,ac as U,ad as W,p as X,aX as z,b6 as Y,a$ as q}from"./index-BKvL4bCX.js";import{f as j,g as J,h as F,j as Q,k as Z,l as ee,m as te,n as ae,o as ne,p as le,q as ie,r as oe,s as re,u as se,v as de,w as ce,t as ge,e as ve,d as ue,x as G,y as me,z as fe,A as Ae,i as E,B as N}from"./common-data-KpQx_8cR.js";import pe from"./ClockColor-C-UE6aWq.js";const _e={class:"clock-inner"},we={class:"pointer-wrapper pointer-upper bg-contain"},Ee={class:"clock-mask"},Ie={__name:"ClockElement",setup(be,{expose:O}){const I=D(null),c=w({isRotation:!1,lastAngle:0,rotationWatcher:null}),r=w({viewAngle:0}),n=w({isSecond:!1,dataAngle:0,viewAngle:0});window.upperPointer=n;const R=C(()=>({"--image-clock-bg-inner":j,"--image-clock-bg-outer":J,"--image-clock-dial":F,"--image-clock-gear-1":Q,"--image-clock-gear-4":Z,"--image-clock-gear-5":ee,"--image-clock-gear-6":te,"--image-clock-particles":ae,"--image-pointer-lower":ne,"--image-pointer-upper":le,"--image-time-icon-dusk":ie,"--image-time-icon-morning":oe,"--image-time-icon-night":re,"--image-time-icon-noon":se,"--pointer-lower-angle":"".concat(r.viewAngle,"deg"),"--pointer-lower-angle-value":r.viewAngle,"--pointer-upper-angle":"".concat(n.viewAngle,"deg"),"--pointer-upper-angle-value":n.viewAngle})),_=C(()=>{const{dataAngle:t,isSecond:e}=n;return e?t+360:t});function h(){c.rotationWatcher=setInterval(function(){const t=_.value,e=c.lastAngle;c.isRotation=Math.abs(t-e)>=5,c.lastAngle=t},250)}function L(){clearInterval(c.rotationWatcher)}function T(t){if(t){const e=t.getBoundingClientRect();return{x:e.left+e.width/2,y:e.top+e.height/2}}else return null}function y(){const t=T(I.value);if(!t)return;const e=t.x,a=t.y;let i=0,l=function(o){let g=Date.now();if(g-i>=20)i=g;else return;let{pageX:v,pageY:b}=o,A=v-e,u=b-a,p=Math.round(Math.atan2(u,A)*(180/Math.PI)),s=p+(p>=-90?90:450),m=0,f=r.viewAngle;s>=f?m=s-f:s<f&&(m=s+(360-f));let M=m-n.dataAngle;M<=-180&&(n.isSecond?(m=360,s=360+f):n.isSecond=!0),M>=180&&(n.isSecond?n.isSecond=!1:(m=0,s=f)),n.dataAngle=m,n.viewAngle=s};window.addEventListener("pointermove",l),window.addEventListener("pointerup",function(){window.removeEventListener("pointermove",l)},{once:!0})}function P(){let t=r.viewAngle,e=_.value,a=e,i=setInterval(()=>{a=Math.max(0,a-2),a===0&&(clearInterval(i),E.value=!1,N.value="");let l=e-a,o=t+l;r.viewAngle=o%360,n.dataAngle=a%360,n.isSecond=a>=360},50);E.value=!0,N.value=G.value}return O({handleSubmitTime:P}),S(()=>r.viewAngle,t=>{let a=(t+(t<180?180:-180))/15,i=Math.floor(a),l=Math.round((a-i)*60);de.value=String(i).padStart(2,"0"),ce.value=String(l).padStart(2,"0"),ge.value=a},{immediate:!0}),S(()=>n.dataAngle,t=>{let e=n.isSecond,a=r.viewAngle,i=n.viewAngle,l=t+(e?360:0),o=0,g=0,v="",A=(i+(i<180?180:-180))/15,u=Math.floor(A),p=Math.round((A-u)*60);a<180?(o=180-a,g=o+360):(o=540-a,g=o+360),l<o?v="今日":l<g?v="次日":v="+2日",u>=24&&(u-=24),ve.value=l<7.5,ue.value=l===720,G.value=v,me.value=String(u).padStart(2,"0"),fe.value=String(p).padStart(2,"0"),Ae.value=A},{immediate:!0}),K(()=>{h()}),B(()=>{L()}),(t,e)=>(V(),H("div",{ref_key:"clockElement",ref:I,class:z({"clock-element":!0,"clock-rotation":c.isRotation}),style:Y(R.value),onTouchmove:e[1]||(e[1]=q(()=>{},["prevent"]))},[e[4]||(e[4]=d("div",{class:"clock-outer bg-contain"},null,-1)),d("div",_e,[e[2]||(e[2]=k('<div class="inner-bg bg-cover" data-v-d36ba493></div><div class="inner-star bg-cover" data-v-d36ba493></div><div class="clock-gear" data-v-d36ba493><div class="gear-6" data-v-d36ba493></div><div class="gear-5" data-v-d36ba493></div><div class="gear-4" data-v-d36ba493></div><div class="gear-3" data-v-d36ba493></div><div class="gear-2" data-v-d36ba493></div><div class="gear-1" data-v-d36ba493></div></div>',3)),$(pe,{"curr-angle":_.value,"start-angle":r.viewAngle},null,8,["curr-angle","start-angle"]),e[3]||(e[3]=d("div",{class:"pointer-wrapper pointer-lower bg-contain"},[d("div",{class:"pointer-content"})],-1)),d("div",we,[d("div",{class:"pointer-content",onPointerdown:e[0]||(e[0]=a=>y())},null,32)])]),e[5]||(e[5]=k('<div class="clock-dial bg-contain" data-v-d36ba493><div class="time-icons" data-v-d36ba493><div class="time-morning bg-contain" style="--self-angle-1:270;--self-angle-2:270;" data-v-d36ba493></div><div class="time-noon bg-contain" style="--self-angle-1:0;--self-angle-2:360;" data-v-d36ba493></div><div class="time-dusk bg-contain" style="--self-angle-1:90;--self-angle-2:90;" data-v-d36ba493></div><div class="time-night bg-contain" style="--self-angle-1:180;--self-angle-2:180;" data-v-d36ba493></div></div></div>',1)),U(d("div",Ee,null,512),[[W,X(E)]])],38))}},ke=x(Ie,[["__scopeId","data-v-d36ba493"]]);export{ke as default};
